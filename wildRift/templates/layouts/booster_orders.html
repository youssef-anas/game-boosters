
  <div class="col-lg-3 col-12 mb-lg-0 mb-4 information text-center">

    <div class="user-info shadow p-4">
      <img src="{% static 'base/images/no_profile_image.jpg' %}" class="profile-image" alt="profile" />
      <h4 class="my-3">{{order.order.order.customer.first_name}} {{order.order.order.customer.last_name}}</h4>
      <hr>

      <p class="text-start">Order Information</p>
      <div class="d-flex justify-content-between align-item-center">
        <p class="text-secondary">Order Name</p>
        <p>{{order.order.order.name}}</p>
      </div>

      <div class="d-flex justify-content-between align-item-center">
        <p class="text-secondary">Server</p>
        <p>{{order.order.order.customer_server|server_name}}</p>
      </div>

      <div class="d-flex justify-content-between align-item-center">
        <p class="text-secondary">In-Game</p>
        <p>{{order.order.order.customer_gamename}}</p>
      </div>

      {% if not order.order.order.duo_boosting  %}
      <div class="d-flex justify-content-between align-item-center">
        <p class="text-secondary">Password</p>
        <p>{{order.order.order.customer_password}}</p>
      </div>
      {% endif %}

      <form action="{% url 'confirm.details' %}" method="POST">
        {% csrf_token %}
        <input type="hidden" name="order_id" value="{{ order.order.order.id }}">
        <button type="submit" class="btn submit-btn">Confirm Details & Start</button>
      </form>

      <form action="{% url 'ask.customer' %}" method="POST" class="mt-3">
        {% csrf_token %}
        <input type="hidden" name="order_id" value="{{ order.order.order.id }}">
        <button type="submit" class="btn btn-warning text-white">Ask Customer to Specify Details</button>
      </form>
    </div>

    <div class="order-info my-4 shadow p-4">

      <h4 class="mb-5">Boost Progression</h4>
      <div class="from row">
        <p class="my-3 text-uppercase col-4 px-0">From</p>
        <img class="text-center col-4 px-0" src="{{order.order.current_rank.get_image_url}}" width="70" />
        <div class="col-4 px-0">
          <p class="my-3 text-uppercase px-0 mb-0">{{order.order.current_rank}} {{ order.order.current_division|romanize_division }}</p>
          <span class="text-secondary" style="font-size: 12px;">{{order.order.current_marks}} Marks</span>
        </div>
      </div>

      <i class="fa-solid fa-angle-down my-3" style="color: var(--secondary-color);"></i>

      <div class="now row">
        <p class="my-3 text-uppercase col-4 px-0">Now</p>
        <img class="text-center col-4 px-0" src="{{order.order.reached_rank.get_image_url}}" width="70" />
        <div class="col-4 px-0">
          <p class="my-3 text-uppercase px-0 mb-0">{{order.order.reached_rank}} {{ order.order.reached_division|romanize_division }}</p>
          <span class="text-secondary" style="font-size: 12px;">{{order.order.reached_marks}} Marks</span>
        </div>
      </div>

      <i class="fa-solid fa-angle-down my-3" style="color: var(--secondary-color);"></i>

      <div class="to row">
        <p class="my-3 text-uppercase col-4 px-0">TO</p>
        <img class="text-center col-4 px-0" src="{{order.order.desired_rank.get_image_url}}" width="70" />
        <p class="my-3 text-uppercase col-4 px-0">{{order.order.desired_rank}} {{ order.order.desired_division|romanize_division }}</p>
      </div>
      <hr>

      <div class="process">
        <p>Progress: <span class="fw-bold">{{order.percentage}}%</span> of 100%</p>
        <div class="progress mb-3" style="height: 17px; background-color: #02a95c1f;">
          <div class="progress-bar" role="progressbar" style="width: {{ order.percentage }}%; height: 17px; background-color: var(--secondary-color)" aria-valuenow="{{ order.percentage }}" aria-valuemin="0" aria-valuemax="100">
          </div>
        </div>
      </div>

      <div class="payout-progress mt-4">
        <p>Payout Progress: <span class="fw-bold">${{order.now_price}}</span> of ${{order.order.order.actual_price}}</p>
        <div class="progress mb-3" style="height: 17px; background-color: #02a95c1f;">
          <div class="progress-bar" role="progressbar" style="width: {{ order.percentage }}%; height: 17px; background-color: var(--secondary-color)" aria-valuenow="{{ order.percentage }}" aria-valuemin="0" aria-valuemax="100">
          </div>
        </div>
      </div>

      {% if order.percentage < 80 %}
      <form action="{% url 'drop.order' %}" method="POST" class="mt-3">
        {% csrf_token %}
        <input type="hidden" name="order_id" value="{{ order.order.order.id }}">
        <button type="submit" class="btn submit-btn"><i class="fa-solid fa-xmark"></i> Drop Order</button>
      </form>
      {% endif %}
      <hr>

      <div class="updata-now">
        <h5 class="my-4">Now Rank</h5>
        <form action="{% url 'order.update.rating' %}" method="POST">
          {% csrf_token %}
          {% if error %} <p class="text-danger">{{error}}</p> {% endif %}
          <input type="hidden" name="order_id" value="{{ order.order.order.id }}">

          <!-- <div class="form-floating">
            <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
              <option selected>Open this select menu</option>
              <option value="1">One</option>
              <option value="2">Two</option>
              <option value="3">Three</option>
            </select>
            <label for="floatingSelect">Works with selects</label>
          </div> -->

          <div class="mb-3">
            <!-- <label class="form-label custom-label my-0" for="reached_rank" style="margin: 0 !important;">Rank</label> -->
            <select class="form-select custom-input" required name="reached_rank" id="reached_rank">
              {% for rank in ranks %}
              {% with mark=rank.mark %}
              <option value="{{ rank.id }}" data-mark="{{ mark.mark_number }}" {% if rank.rank_name|lower == order.order.reached_rank|lower %} selected {% endif %}>{{ rank.rank_name }}</option>
              {% endwith %}
              {% endfor %}
            </select>
          </div>

          <div class="input-group mb-3">
            <!-- <label class="input-group-text my-0" for="reached_division" style="margin: 0 !important;">Division</label> -->
            <select class="form-select custom-input" required name="reached_division" id="reached_division">
              <option value="1" {% if order.order.reached_division == 1 %}selected{% endif %}>IV</option>
              <option value="2" {% if order.order.reached_division == 2 %}selected{% endif %}>III</option>
              <option value="3" {% if order.order.reached_division == 3 %}selected{% endif %}>II</option>
              <option value="4" {% if order.order.reached_division == 4 %}selected{% endif %}>I</option>
            </select>
          </div>

          <div class="input-group mb-3">
            <!-- <label class="input-group-text my-0" for="reached_marks" style="margin: 0 !important;">Marks</label> -->
            <select class="form-select custom-input" required name="reached_marks" id="reached_marks">
              <option value="0" {% if order.order.reached_marks == 0 %}selected{% endif %}>0 Mark</option>
              <option value="1" {% if order.order.reached_marks == 1 %}selected{% endif %}>1 Marks</option>
              <option value="2" {% if order.order.reached_marks == 2 %}selected{% endif %}>2 Marks</option>
              <option value="3" {% if order.order.reached_marks == 3 %}selected{% endif %}>3 Marks</option>
              <option value="4" {% if order.order.reached_marks == 4 %}selected{% endif %}>4 Marks</option>
              <option value="5" {% if order.order.reached_marks == 5 %}selected{% endif %}>5 Marks</option>
              <option value="6" {% if order.order.reached_marks == 6 %}selected{% endif %}>6 Marks</option>
            </select>
          </div>

          <div class="text-end">
            <button type="submit" class="btn submit-btn">Update Rating</button>
          </div>
        </form>

        <div class="my-3">
        {% if order.order.reached_rank.id > order.order.desired_rank.id %}
          <!-- Button trigger modal -->
          <button type="button" class="btn submit-btn" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
            <i class="fa-regular fa-circle-check"></i> Complete Order
          </button>
        {% elif order.order.reached_rank.id == order.order.desired_rank.id   and order.order.reached_division >= order.order.desired_division %}
        <!-- Button trigger modal -->
        <button type="button" class="btn submit-btn" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
          <i class="fa-regular fa-circle-check"></i> Complete Order
        </button>
        {% endif %}
        <!-- Modal -->
        <div class="modal modal-lg fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
          <div class="modal-dialog" style="background-color: var(--main-color);">
            <div class="modal-content" style="background-color: var(--main-color);">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="staticBackdropLabel">Upload Complete Image</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="color: var(--secondary-color); !important"></button>
              </div>
              <div class="modal-body">

                <form action="{% url 'order.upload.image' %}" method="POST" enctype="multipart/form-data">
                  {% csrf_token %}
                  {% if error %} <p class="text-danger">{{error}}</p> {% endif %}
                  <input type="hidden" name="order_id" value="{{ order.order.order.id }}">

                  <!-- Image preview -->
                  <div class="d-flex justify-content-center align-items-center">
                    <img src="#" alt="Preview" id="image-preview" style="max-width: 100%; max-height: 400px; display: none; margin-bottom: 3rem;">
                  </div>

                  <label for="images" class="drop-container" id="dropcontainer">
                    <span class="drop-title">Drop files here</span>
                    or
                    <input type="file" name="finish_image" id="finish_image" required>
                  </label>

                  <div class="text-end">
                    <button type="submit" class="btn submit-btn my-3">Submit</button>
                  </div>
                </form>

              </div>
            </div>
          </div>
        </div>
      </div>
      </div>
    </div>
  </div>

  
